
<style>
    #ranking .user {
        position: relative;
        margin-top: 1px;
    }
    #ranking .user:nth-child(odd) {
        background: gainsboro;
    }

    #ranking .user > * {
        display: inline-block;
        vertical-align: top;
    }

    #ranking .user .picture {
        width: 60px;
        height: 60px;
    }

    #ranking .user .num {
        /*background-color: red;*/
        /*color: white;*/
        font-size: 24px;
        width: 60px;
        text-align: center;
        line-height: 60px;
    }

    #ranking .user .name {
        margin-left: 15px;
        position: absolute;
        top: 50%;
        transform: translateY(-50%);
    }

    #ranking .user .points {
        position: absolute;
        right: 50px;
        top: 20px;
        color: gray;
    }

    #ranking .user .fa {
        font-size: 24px;
        position: absolute;
        right: 15px;
        line-height: 60px;
    }
</style>

<template>
    <div id='ranking'>

        <div v-for='(user, index) in users' class='user' v-on:click='showUser(user)'>
            <div class='num'>
                {{index + 1}}
            </div>
            <div class='picture' v-bind:style="'background-image:url(' + user.profile_picture + ')'"></div>
            <div class='name'>
                <div>
                    {{user.username}}
                </div>
                <div style="color:grey">
                    {{user.full_name}}
                </div>
            </div>

            <div class='points'>
                {{user.points}}
            </div>

            <!--<i class="fa fa-arrow-up"></i>-->
            <i class="fa" style='font-size: 36px; font-weight: bold'>=</i>
            <!--<i class="fa fa-arrow-down"></i>-->
        </div>

    </div>
</template>

<script>

    define({
        template: template,
        data: {
            users: {}
        },
        mounted: function () {
            var self = this;

            var token = get_access_token();
            if (!token) {
                return;
            }

            var api = "https://api.instagram.com/v1/";

            $.get(api + "users/self/?access_token=" + token, function (res) {
                var user_id = res.data.id;

                //update server
                $.post(window.server + "user@update", {
                    access_token: token,
                    user_id: user_id
                }, function (users) {
                    self.users = users;
                });
            });
        },
        methods: {
            showUser: function (username) {
                window.user(username);
            }
        }
    });

</script>
