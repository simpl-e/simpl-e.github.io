<!DOCTYPE html>
<html>
    <head>
        <title>TODO supply a title</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">

        <!--libs-->
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.3/css/bootstrap.min.css">
        <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">

        <link rel="stylesheet" type="text/css" href="styles.css">

        <style>
            .content { 
                padding: 10px;    
            }
            .picture {
                width: 100px;
                height: 100px;
                background-size: cover;
                background-repeat: no-repeat;
            }
        </style>

        <!--libs-->
        <script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.3/js/bootstrap.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/vue/2.5.13/vue.js"></script>

        <script>
            //STORE ACCESS TOKEN 
            if (location.hash.indexOf("access_token=") >= 0) {
                var access_token = location.hash.split("access_token=").pop();
                localStorage.setItem("access_token", access_token);
            }

            function get_access_token() {
                var access_token = localStorage.getItem("access_token");
                if (!access_token) {
                    login();
                    return;
                }
                return access_token;
            }
        </script>

        <script src="lib/requirejs/require.js"></script>
        <script src="app.js"></script>

        <!--[if lt IE 9]>
          <script src="//html5shim.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->
        <!--<link rel="apple-touch-icon" href="/bootstrap/img/apple-touch-icon.png">
        <link rel="apple-touch-icon" sizes="72x72" href="/bootstrap/img/apple-touch-icon-72x72.png">
        <link rel="apple-touch-icon" sizes="114x114" href="/bootstrap/img/apple-touch-icon-114x114.png">-->

    </head>
    <body>

        <div id="header" class="bg-dark">
            <nav class="container navbar navbar-expand-lg navbar-dark">
                <a class="navbar-brand" href="#">Topingram</a>
                <i class="fa fa-bars navbar-toggler" style='font-size:24px; border: none' 
                   data-toggle="collapse" data-target="#navbarColor01"></i>

                <div class="collapse navbar-collapse" id="navbarColor01">
                    <ul class="navbar-nav mr-auto">
                        <li id='logout' class="nav-item active">
                            <a class="nav-link">logout</a>
                        </li>                    
                    </ul>
                </div>
            </nav>
        </div>

        <div id="submenu">
            <nav class="container navbar navbar-dark">
                <div class="row" style='width: 100vw;'>
                    <div class="col-2 text-center">
                        <a href="#page=home">
                            <i class="fa fa-home"></i>
                            <div class='text'><span class='d-none d-sm-block'>Home</span></div>
                        </a>
                    </div>
                    <div class="col-2 text-center">
                        <a href="#page=search">
                            <i class="fa fa-search"></i>
                            <div class='text'><span class='d-none d-sm-block'>Search</span></div>
                        </a>
                    </div>
                    <div class="col-2 text-center">
                        <a href="#page=ranking">
                            <i class="fa fa-list"></i>
                            <div class='text'><span class='d-none d-sm-block'>Ranking</span></div>
                        </a>
                    </div>
                    <div class="col-2 text-center">
                        <a onclick="user()">
                            <i class="fa fa-user"></i>
                            <div class='text'><span class='d-none d-sm-block'>Profile</span></div>
                        </a>
                    </div>
                    <div class="col-2 text-center">
                        <a href="#page=messages">
                            <i class="fa fa-envelope"></i>
                            <div class='text'><span class='d-none d-sm-block'>Message</span></div>
                        </a>
                    </div>
                    <div class="col-2 text-center">
                        <a href="#page=statistics">
                            <i class="fa fa-line-chart"></i>
                            <div class='text'><span class='d-none d-sm-block'>Statistics</span></div>
                        </a>
                    </div>
                </div>
            </nav>
        </div>

        <div id='content' class='container' style="padding: 0">
            <div></div>
        </div>

        <br><br><br>

        <script>

            function login() {
                //var url = "http://localhost/topingram/public_html/index.html";
                //var url = "http://localhost:8383/topingram/index.html";
                var url = location.origin + location.pathname;
                var scope = "basic+public_content+follower_list+comments+relationships+likes"; //ALL
                location.href = "https://api.instagram.com/oauth/authorize/?"
                        + "client_id=045469a8bcac4dd095d95b879ffa2fba"
                        + "&redirect_uri=" + url
                        + "&scope=" + scope
                        + "&response_type=token";
            }

            $("#logout").click(function () {
                $("<iframe src='https://instagram.com/accounts/logout/' width='0' height='0'>").appendTo("body").on("load", function () {
                    localStorage.removeItem("access_token");
                    location.reload();
                });
            });

            function user(user) {
                require(["vue!components/modal.html"], function (modalClass) {
                    var modal = new modalClass();

                    var div = $("<div>").appendTo("body")[0];
                    var vm = new Vue(modal).$mount(div);

                    vm.data = {user: user};
                    vm.page = "pages/profile/profile.html";
                });
            }

        </script>

    </body>
</html>
